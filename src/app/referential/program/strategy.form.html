
<!-- error -->
<ion-item *ngIf="firstError as error" visible-xs visible-sm visible-mobile lines="none">
  <ion-icon color="danger" slot="start" name="alert-circle"></ion-icon>
  <ion-label color="danger" class="error" [innerHTML]="error|translate"></ion-label>
</ion-item>

<!-- base form -->
<app-referential-form #referentialForm
                      [form]="form"
                      [entityName]="'Strategy'"
                      [showError]="false"
                      [debug]="debug"
                      (onSubmit)="save($event)"
                      [class.cdk-visually-hidden]="!showBaseForm">
</app-referential-form>

<!-- Other fields -->
<form [formGroup]="form" class="form-container">
  <ion-grid>
    <ion-row>


      <ion-col size="12" size-lg="4">
        <mat-accordion>

          <!-- Locations -->
          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>
                <ion-text color="primary" translate>PROGRAM.STRATEGY.LOCATIONS</ion-text>
              </mat-panel-title>
              <mat-panel-description *ngIf="locationsList.length">({{locationsList.length}})</mat-panel-description>
            </mat-expansion-panel-header>

            <app-list-form #locationsList
                           [displayWith]="referentialToString"
                           [equals]="referentialEquals"
                           [options]="{allowEmptyArray: true}"
                           (onNewItem)="addLocation()">
            </app-list-form>
          </mat-expansion-panel>

          <!-- Gears -->
          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>
                <ion-text color="primary" translate>PROGRAM.STRATEGY.GEARS</ion-text>
              </mat-panel-title>
              <mat-panel-description *ngIf="gearsList.length">({{gearsList.length}})</mat-panel-description>
            </mat-expansion-panel-header>

            <app-list-form #gearsList
                           [displayWith]="referentialToString"
                           [equals]="referentialEquals"
                           [options]="{allowEmptyArray: true}"
                           (onNewItem)="addGear()">
            </app-list-form>
          </mat-expansion-panel>

          <!-- Taxon Groups -->
          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>
                <ion-text color="primary" translate>PROGRAM.STRATEGY.TAXON_GROUPS</ion-text>
              </mat-panel-title>
              <mat-panel-description *ngIf="taxonGroupsList.length">({{taxonGroupsList.length}})</mat-panel-description>
            </mat-expansion-panel-header>

            <app-list-form #taxonGroupsList
                           [displayWith]="taxonGroupStrategyToString"
                           [equals]="taxonGroupStrategyEquals"
                           [options]="{allowEmptyArray: true}"
                           (onNewItem)="addTaxonGroup()">
            </app-list-form>

          </mat-expansion-panel>

          <!-- Taxon names -->
          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>
                <ion-text color="primary" translate>PROGRAM.STRATEGY.TAXON_NAMES</ion-text>
              </mat-panel-title>
              <mat-panel-description *ngIf="taxonNamesList?.length">({{taxonNamesList.length}})</mat-panel-description>
            </mat-expansion-panel-header>

            <app-list-form #taxonNamesList
                           [displayWith]="taxonNameStrategyToString"
                           [equals]="taxonNameStrategyEquals"
                           [options]="{allowEmptyArray: true}"
                           (onNewItem)="addTaxonName()">
            </app-list-form>
          </mat-expansion-panel>
        </mat-accordion>
      </ion-col>

      <!-- Pmfm strategies -->
      <ion-col>
        <ion-card class="ion-no-margin">
          <app-pmfm-strategies-table #pmfmStrategiesTable
                                     [title]="'PROGRAM.STRATEGY.PMFM_STRATEGY.TABLE.TITLE'|translate"
                                     [canEdit]="enabled"
                                     [canDelete]="enabled">
          </app-pmfm-strategies-table>
        </ion-card>

      </ion-col>
    </ion-row>
  </ion-grid>

</form>

